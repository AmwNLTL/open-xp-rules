ContentAutoName: MacOS_Privilege_Escalation_via_security_authtrampoline
ExpertContext:
    Created: 26.06.2024
    Updated: 27.06.2024
    KnowledgeHolders:
        - Kirill Shamko
    Usecases:
        - Злоумыленник может использовать AuthorizationExecuteWithPrivileges API для повышения привилегий, запрашивая ввод пароля у пользователя. Утилитой, использующей данный API, является security_authtrampoline. Любой запуск данной утилиты является подозрительным.
    Falsepositives: []
    References:
        - https://www.jamf.com/blog/detecting-insecure-application-updates-on-macos/
        - https://objective-see.org/blog/blog_0x55.html
        - https://theevilbit.github.io/posts/macos_authorization/#factored-applications-privileged-helper-tools
    Improvements: []
    DataSources:
        - Provider: MacOS
          EventID:
              - es_logger_process_execution
ObjectId: SEC-CR-107294903
ContentRelations:
    Implements:
        ATTACK:
            privilege-escalation:
                - T1548.004
EventDescriptions:
    - Criteria: correlation_name = "MacOS_Privilege_Escalation_via_security_authtrampoline" and reason = "elevation-success" and datafield19 = "false"
      LocalizationId: corrname_MacOS_Privilege_Escalation_via_security_authtrampoline
    - Criteria: correlation_name = "MacOS_Privilege_Escalation_via_security_authtrampoline" and reason = "elevation-success" and datafield19 = "true"
      LocalizationId: corrname_MacOS_Privilege_Escalation_via_security_authtrampoline_2
    - Criteria: correlation_name = "MacOS_Privilege_Escalation_via_security_authtrampoline" and reason = "elevation-attempt" and datafield19 = "false"
      LocalizationId: corrname_MacOS_Privilege_Escalation_via_security_authtrampoline_3
    - Criteria: correlation_name = "MacOS_Privilege_Escalation_via_security_authtrampoline" and reason = "elevation-attempt" and datafield19 = "true"
      LocalizationId: corrname_MacOS_Privilege_Escalation_via_security_authtrampoline_4
